<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Input</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            color: red;
            margin: 20px;
        }
        #errorText {
            color: red;
        }
    </style>
</head>
<body>
    <form id="secretForm">
        <label for="hiddenInput">Enter Secret:</label>
        <input type="text" id="hiddenInput" placeholder="Type here..." oninput="maskInput(event)" onkeydown="checkEnter(event)">
        <input type="submit" value="Submit">
    </form>
    <p id="errorText"></p>
    <p id="submittedValue"></p>

    <script>
        let originalValue = ""; // Holds the real value entered by the user
        let shownValue = "";    // Holds the masked value shown to the user

        // Function to handle input masking
        function maskInput(event) {
            const inputField = event.target;
            const currentValue = inputField.value;
            inputField.value = updateShownValue(currentValue);
        }

        // Function to check if the entered character is valid
        function isValidCharacter(char) {
            const validCharacters = new Set(['s', 'd', 'f', 'j', 'k', 'l', ' ']);
            return validCharacters.has(char);
        }

        // Function to update the shown value based on user input
        function updateShownValue(currentValue) {
            // Only process if a new character has been added
            if (currentValue.length > shownValue.length) {
                const newChar = currentValue.slice(-1); // Get the last typed character

                if (!isValidCharacter(newChar)) {
                    displayError("You submitted an invalid character, please try again.");
                    return shownValue; // Return the last valid shown value
                } else {
                    clearError();
                }

                // Append the valid character to the original value
                originalValue += newChar;

                // Update the shown value with asterisks for spaces
                shownValue += (newChar === " ") ? "*" : "";
            }

            return shownValue;
        }

        // Function to display an error message
        function displayError(message) {
            document.getElementById('errorText').textContent = message;
        }

        // Function to clear the error message
        function clearError() {
            document.getElementById('errorText').textContent = "";
        }

        // Function to handle form submission
        function submitForm(event) {
            event.preventDefault(); // Prevent the form from reloading the page
            document.getElementById('submittedValue').textContent = "Submitted Value: " + originalValue;
        }

        // Function to check for the Enter key and submit the form if pressed
        function checkEnter(event) {
            if (event.key === "Enter") {
                submitForm(event);
                const inputField = event.target;
                inputField.value += "*"; // Mask the input further
            }
        }

        // Event listeners
        document.getElementById('secretForm').addEventListener('submit', submitForm);
    </script>
</body>
</html>
